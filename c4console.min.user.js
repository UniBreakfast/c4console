// ==UserScript==
// @name        c4console.min
// @namespace   Violentmonkey Scripts
// @match       *://*/*
// @run-at      document-start
// @grant       none
// @version     3.0.5
// @author      Tut 'UniBreakfast' Ninin
// @description 15.06.2020, 06:31:18
// ==/UserScript==
{let e;const t=()=>(new Date).toLocaleTimeString("en",{hour12:!1}),o=(e,t=.4,n=" ")=>{if(e.match(/^data:image\/.*;base64,/))return a(new Image,{src:e,onload(){i(`%c${n}`,`background: no-repeat url(${e});padding:0 ${this.width*t}px ${this.height*t}px 4px;background-size:contain`)}});fetch(e).then(e=>e.blob()).then(e=>a(new FileReader,{onload(){o(this.result,t)}}).readAsDataURL(e))},n=localStorage,{defineProperty:s,assign:a}=Object,{log:i,dir:l}=console,c=Object.prototype,r=Promise.prototype,h=window,d=(e,t,o)=>s(e,t,{value:o,enumerable:!1,editable:!0,configurable:!0});c4=h.c4console={cGlobalFn:(...e)=>(1==e.length&&(e[0]instanceof Element||e[0]==document)?l:i)(...e)||e.length>1?e:e[0],cGenericMethod(o){const n=t(),s=this.valueOf(),a=s instanceof Element||s==document;return i(...n==e?[]:[e=n],..."string"==typeof o?[o+":"]:"number"==typeof o?[o+"."]:[],...a?[]:[s]),a&&l(s),s},cPromiseMethod(n){let s=e=>e,l=e=>e;const c=t(),r=new Date,h="response body",d=(t,s)=>{i(...c==e?[]:[e=c],..."string"==typeof n?[n+":"]:"number"==typeof n?[n+"."]:[],`${s} in ${new Date-r}ms`,t),t instanceof Response&&200==t.status&&((t.headers.get("content-type")||"").startsWith("image/")?t.clone().blob().then(e=>a(new FileReader,{onload(){o(this.result,.4,h)}}).readAsDataURL(e)):t.clone().text().then(e=>{try{JSON.parse(e).c(h)}catch{e.c(h)}}))},u=this.then(e=>d(e,"resolved")||s(e),e=>d(e,"rejected")||l(e));return this.then=((e,t)=>(e&&(s=e),t&&(l=t),u)),this.catch=u.catch=(e=>(l=e)&&u),this},on(){console.img=this.img,h.c=this.cGlobalFn,d(c,"c",this.cGenericMethod),d(r,"c",this.cPromiseMethod),this.status().includes("OFF")&&(this.off(),i("sorry, unable to turn ON"))},off(){console.img==this.img&&delete console.img,h.c==this.cGlobalFn&&delete h.c,c.c==this.cGenericMethod&&delete c.c,r.c==this.cPromiseMethod&&delete r.c},status(){return(h.c==this.cGlobalFn&&c.c==this.cGenericMethod&&r.c==this.cPromiseMethod?"ON":"OFF")+" / "+("enabled"==n.c4?"enabled":"disabled")},enable(){n.c4="enabled",c4.on()},disable(){n.c4="disabled",c4.off()},img:o,getTime:t,get lastTime(){return e},greet(){i(`Hi. c4console is now ${this.status()} and c4console.help() is there for you`)},help(){i(`c4console is now ${this.status()}\n\nc4console provides following methods:\n\n  .help() - shows the text you are reading;\n  .on() - turns ON c4console functionality (see below) for this page just until reload;\n  .off() - turns OFF ... the same as previous;\n  .enable() - enables c4console functionality for this page until disabled;\n  .disable() - disables ... the same until enabled\n\nit isn't enabled by default because many big sites won't load if they see that standard prototypes were modified before they themselves did that same thing (like Facebook, YouTube or Google). So you can turn c4console ON on those too BUT don't enable it for them by default or do not forget how to disable it.\n\nc4console functionality includes:\n\n  c(...args) - global function like console.log but it also returns the stuff it outputs;\n  any_variable_or_value.c(?label) - method available on (almost) any value that allows you to output that value to the console and that call is "transparent" for the chaining methdods - it returns the thing if was called from, so you can insert it in the middle of any expression without breaking anything;\n  any_promise.c(?label) - method available on any promise that also outputs to the console the final status of the promise, time it took and its value, and, if it was a fetch response, it outputs the response body below - as text, json-parsed object/array or image;\n  console.img(src, ?size, ?label) - function to show images in console, prefers Base64 strings as a source but can also fetch images implicitly if url provided instead\n`)}},"enabled"==n.c4&&c4.on(),c4.greet()}